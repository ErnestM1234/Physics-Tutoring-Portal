<!DOCTYPE html>
<html>
    <head>
      <title>Physics Tutoring Portal Tutorship </title>
      <link rel="stylesheet" href= "{{url_for('static', filename='custom.css')}}">
      <link href='https://fonts.googleapis.com/css?family=Arvo' rel='stylesheet'>

      <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>

    <body class="princeton-gradient">

      &nbsp;
      {% include "/components/admin-sidebar-header.html" %}

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script>
            function set_tutor_course_status(tutor_course_id, status) {
                const data = {
                    tutor_course_id,
                    status
                }
                $.post("/admin/tutors/update_status", data, function(result){
                    // $("#course-results").html(result);
                    console.log(result)
                });
            }
        </script>


        <div>
          {% include '/components/admin-dashboard-title.html' %}
            <br>

            <br>

            {% if course  %}
                <h2 class="text-center"><strong>COURSE NAME: {{course.name}}</strong></h2>
                <h2 class="text-center"><a href="{{'/admin/courses/remove-course/?course_id=' + course.id | string}}">Delete course</a></h2>
            {% endif %}
            <br>

            <h3><strong>Tutorships for {{course.name}}</strong></h3>

            <a href="/admin/tutorships/create-tutorship">Add a new tutorship</a><br>
    
            <div class ="list">
            <table class="table">
                <thead>
                  <tr>
                    <!-- <th class="bg-white" scope="col">Tutorship Id</th> -->
                    <!-- <th class="bg-white" scope="col">Student Id</th> -->
                    <th class="bg-white" scope="col">Student Name</th>
                    <!--<th class="bg-white" scope="col">Tutor Id</th> -->
                    <th class="bg-white" scope="col">Tutor Name</th>
                    <!--<th class="bg-white" scope="col">Course Id</th>-->
                    <th class="bg-white" scope="col">Course Name</th>
                    <th class="bg-white" scope="col">Status</th>
                    <th class="bg-white" scope="col">Action</th>
                  </tr>
                </thead>
                <tbody>
                    {% for tutorship in tutorships %}
                        <tr>
                            <!--<td class="bg-white">{{tutorship.id}}</td>-->
                            <!--<td class="bg-white">{{tutorship.student_id}}</td>-->
                            <td class="bg-white"><a href="{{'/admin/student-profile/?student_id=' + tutorship.student_id | string}}">{{tutorship.student.name}}</a></td>
                            <!--<td class="bg-white">{{tutorship.tutor_id}}</td>-->
                            <td class="bg-white"><a href="{{'/admin/tutor-profile/?tutor_id=' + tutorship.tutor_id | string}}">{{tutorship.tutor.name}}</a></td>
                            <!--<td class="bg-white">{{tutorship.course_id}}</td>-->
                            <td class="bg-white">{{tutorship.course.name}}</td>
                            <td class="bg-white">{{tutorship.status}}</td>
                            <td class="bg-white"><a href="{{'/admin/tutorships/remove-tutorship/?tutorship_id=' + tutorship.id | string}}"><button>Dissolve</button></a></td>
                        </tr>
                    {% endfor %}
                </tbody>
              </table>
            </div>
            <br>
            <br>
            <br>

            <h3><strong>Tutors for {{course.name}}: </strong></h3>


            <h3>Accepted Tutors</h3>
            <a href="/admin/create-tutor-course">Assign a tutor to a course</a><br>
    
            <div class ="list">
            <table class="table">
                <thead>
                  <tr>
                    <!--<th class="bg-white" scope="col">Id</th>-->
                    <th class="bg-white" scope="col">Name</th>
                    <th class="bg-white" scope="col">Course Name</th>
                    <!--<th class="bg-white" scope="col">Course Id</th>-->
                    <th class="bg-white" scope="col">Status</th>
                    <th class="bg-white" scope="col">Student Count</th>
                    <th class="bg-white" scope="col">Profile</th>
                    <!--<th class="bg-white" scope="col">Action</th>-->
                  </tr>
                </thead>
                <tbody>
                    {% for tutor_course in tutor_courses %}
                        <tr>
                            <!--<td class="bg-white">{{tutor_course.id}}</td>-->
                            <td class="bg-white">{{get_name(tutor_course.tutor_id)}}</td>
                            <td class="bg-white">{{tutor_course.course_name}}</td>
                            <!--<td class="bg-white">{{tutor_course.course_id}}</td>-->
                            <td class="bg-white">{{tutor_course.status}}</td>
                            <td class="bg-white">{{student_count[loop.index0]}}</td>
                            <td class="bg-white"><a href="{{'/admin/tutor-profile/?tutor_id=' + tutor_course.tutor_id | string}}">Profile</a></td>
                            <!--<td class="bg-white"><button onclick="set_tutor_course_status( {{tutor_course.id}}, 'DENIED' )">Revoke</button></td>-->
                        </tr>
                    {% endfor %}
                </tbody>
              </table>
            </div>
    
    
            <br><br><br>
    
            
            <h3>Tutor Requests</h3>
    
            <div class ="list">
            <table class="table">
                <thead>
                  <tr>
                    <!--<th class="bg-white" scope="col">Id</th>-->
                    <th class="bg-white" scope="col">Name</th>
                    <th class="bg-white" scope="col">Course Name</th>
                    <!--<th class="bg-white" scope="col">Course Id</th>-->
                    <th class="bg-white" scope="col">Tutorships</th>
                    <th class="bg-white" scope="col">Profile</th>
                    <!--<th class="bg-white" scope="col">Action</th>-->
                  </tr>
                </thead>
                <tbody>
                    {% for tutor_request in tutor_requests %}
                        <tr>
                            <!--<td class="bg-white">{{tutor_request.id}}</td>-->
                            <td class="bg-white">{{get_name(tutor_request.tutor_id)}}</td>
                            <td class="bg-white">{{tutor_request.course_name}}</td>
                            <td class="bg-white">{{tutor_request.course_id}}</td>
                            <td class="bg-white">{{student_count[loop.index0]}}</td>
                            <td class="bg-white"><a href="{{'/admin/tutor-profile/?tutor_id=' + tutor_request.tutor_id | string}}">Profile</a></td>
                           <!--<td class="bg-white">
                                <button onclick="set_tutor_course_status( {{tutor_request.id}}, 'ACCEPTED' )">Approve</button>
                                <button onclick="set_tutor_course_status( {{tutor_request.id}}, 'DENIED' )">Deny</button>
                            </td>-->
                        </tr>
                    {% endfor %}
                </tbody>
              </table>
            </div>
    
            <br><br><br>
    
            <h3>Denied Tutors</h3>
    
            <div class ="list">
            <table class="table">
                <thead>
                  <tr>
                    <!--<th class="bg-white" scope="col">Id</th>-->
                    <th class="bg-white" scope="col">Name</th>
                    <th class="bg-white" scope="col">Course Name</th>
                    <!--<th class="bg-white" scope="col">Course Id</th>-->
                    <th class="bg-white" scope="col">Profile</th>
                    <!--<th class="bg-white" scope="col">Action</th>-->
                  </tr>
                </thead>
                <tbody>
                    {% for denied_tutor in denied_tutors %}
                        <tr>
                            <!--<td class="bg-white">{{denied_tutor.id}}</td>-->
                            <td class="bg-white">{{get_name(denied_tutor.tutor_id)}}</td>
                            <td class="bg-white">{{denied_tutor.course_name}}</td>
                            <!--<td class="bg-white">{{denied_tutor.course_id}}</td>-->
                            <td class="bg-white"><a href="{{'/admin/tutor-profile/?tutor_id=' + denied_tutor.tutor_id | string}}">Profile</a></td>
                            <!--<td class="bg-white">
                                <button onclick="set_tutor_course_status( {{denied_tutor.id}}, 'ACCEPTED' )">Approve</button>
                            </td>-->
                        </tr>
                    {% endfor %}
                </tbody>
              </table>
            </div>
    
        </div>




        {% include "/components/sidebar-footer.html" %}


    </body>
